<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
  <head>
      <meta charset="utf-8">
      <title>Sound Board</title>

      <!-- CSS -->
      <link href="./styles.css" rel="stylesheet" type="text/css">
  </head>
  <body>

    <header>
        <h1>SOUNDBOARD</h1>
    </header>
    <main>
        <div class="sound-button" data-note-number="1">
          Note 1
          <br/><br/>
          (press A)</div>
        <div class="sound-button" data-note-number="2">
          Note 2
          <br/><br/>
          (press D)</div>
        <div class="sound-button" data-note-number="3">
          Note 3
          <br/><br/>
          (press J)</div>
        <div class="sound-button" data-note-number="4">
          Note 4
          <br/><br/>
          (press K)</div>
        <div class="sound-button" data-note-number="5">
          Note 5
          <br/><br/>
          (press L)</div>
    </main>
    <footer>Let's make some noise!</footer>
  </body>

  <script src="./primus.js" type="text/javascript"></script>
  <script src="//code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    
    var noisemakerServerAddr = 'http://localhost:8080';
    var myPool, myRank;

    $(document).ready(function(){
      
      /* Getting Pool and Rank assignments */
      $.get(noisemakerServerAddr + '/assignment', function(data){
        myPool = data.pool;
        myRank = data.rank;
      });

      var primus = Primus.connect('http://localhost:8080');
      primus.on('open', function () {
        primus.send('soundboard join');
        console.log('successfully joined sound controller room!');
      });

      //start playing the note
      $('.sound-button').mousedown(function(){
        var myInfo = {
          note: $(this).data('note-number'),
          pool: myPool,
          rank: myRank
        }
        primus.send('play note', myInfo);
        $(this).addClass('active');
        console.log('play note event fired!');
      });

      //stop playing the note
      $('.sound-button').mouseup(function(){
        $(this).removeClass('active');
      });
    });
  </script>

  </body>
</html>
